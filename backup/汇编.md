# 基本语法

汇编程序可以分为三个段

* data段
* bss段
* text段

## data段

数据段被用于声明初始化的数据或常数。此数据在运行时不会更改。可以在段中声明各种常用值，文件名或缓冲区大小等。

```nasm
section.data
```

## bss段

在bss声明变量。

```nasm
section.bss


```

## text段

代码段被用于保持实际的代码。该段必须以全集声明_start开头，该声明告诉内核程序从何处开始执行。

```nasm
section.test
    global _start
_start:
```

## 注释

汇编语言注释以分号(;)开头。它可以包含任何可打印字符，包括空格。它可以单独出现在一行上。

```nasm
;该程序在屏幕上显示一条信息
```

或者，与指令在同一行上。

```nasm
add eax, ebx ;加上ebx的值到eax
```

## 汇编语言声明

汇编语言程序包含三种类型的语句

* 可执行指令或说明
* 汇编程序指令或伪操作
* 宏

可执行指令或简单的指令告诉处理器做什么。每个指令由一个操作码组成。每个可执行指令生成一个机器语言指令。该汇编指令或位操作讲述装配过程中的各方面的汇编。这些是不可执行的，不会生成机器语言指令。宏是一种代码替换机制。

## 汇编语言语句的语法

汇编语言语句每行输入一个语句。每个语句遵循一下格式

```nasm
[label] mnemonic [operands] [;comment]
```

基本命令包括两段，第一段是要执行的指令（或助记符）的名称，第二段是命令的操作数或参数。以下是一些典型汇编语句的示例

```nasm
inc count         ; 增加内存变量count
mov total, 48     ; 将值48转移到内存变量total
add ah,bh         ; 将寄存器BH内容添加到ah寄存器
and mask1, 128    ; 对变量mask1 和 128执行and操作

add marks, 10     ; 将10加到变量marks
mov al, 10        ; 将值10传送到al寄存器
```

## 汇编语言的Hello World 程序

```nasm
section .text
	global _start
_start:
	mov edx,len	; message length
	mov ecx,msg	; message to write
	mov ebx,1	; file descriptor(stdout)
	mov eax,4	; system call number(sys_write)
	int 0x80	; call kernel

	mov eax,1	; system call number(sys)
	int 0x80	; call kernel

section .data
msg db 'Hello, world!', 0xa	;string to be printed
len equ $ - msg			;length of the string

```

在NASM中编译和链接程序

```shell
nasm -f elf hello.asm
# 链接目标文件
ld -m elf_i386 -s -o hello hello.o
```



# 内存复制

# 堆栈指令


# 汇编如何写函数


# 堆栈传参


# 堆栈平衡


参考文档: 
[简明 x86 汇编指南](https://arthurchiao.art/blog/x86-asm-guide-zh/)